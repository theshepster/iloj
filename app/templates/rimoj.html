{% extends "base.html" %}
{% import 'bootstrap/wtf.html' as wtf %}

{% block styles %}
{{ super() }}
<style>
    
    .errors {
        border: 1px solid #ba1f35;
        margin: 0;
        padding: 0.5em 1em;
        margin-bottom: 1.5em;
        -moz-border-radius: 5px;
        -khtml-border-radius: 5px;
        -webkit-border-radius: 5px;
        border-radius:5px
    }

    .errors dt {
        color: #ba1f35;
        font-size: 1.5em;
        line-height: 1.5em;
        font-family: Arial, Verdana, sans-serif;
        margin: 0;
        padding: 0;
        margin-bottom: 0.3em;
        padding-left: 2em;
        background: transparent url("../static/error.png") no-repeat scroll left/2%
    }
    
    .errors dd {
        line-height: 1.5em;
        margin: 0;
        padding:0
    }
</style>

{% endblock %}

{% block app_content %}
<p>
    {{ wtf.quick_form(form, method='POST') }}
</p>
<br>
    {% if results|length == 0 and method == 'POST' %}

        <dl class="errors">
            <dt>Ho, baf!</dt>
            <dd>Neniu traf'. Provu per alia paf'!</dd>
        </dl>

    {% endif %}

    {% for result in results %}
        <h2>{{ result.matchString }}</h2>
        <br>
        {% for match in result.wordLinks %}
        <div>
            <p>
                <a href="{{ match[1] }}">{{ match[0] }}</a>
            </p>
        </div>
        {% endfor %}
    {% endfor %}
{% endblock %}

{% block scripts %}
<script> 
    queryBox = document.getElementById('query')

    const replaceChars = function(e) {
        newVal = e.target.value.toLowerCase()
        newVal = newVal.replace('gx', 'ĝ');    
        newVal = newVal.replace('cx', 'ĉ'); 
        newVal = newVal.replace('sx', 'ŝ'); 
        newVal = newVal.replace('hx', 'ĥ'); 
        newVal = newVal.replace('jx', 'ĵ'); 
        newVal = newVal.replace('ux', 'ŭ'); 
        e.target.value = newVal;
    }

    queryBox.addEventListener('input', replaceChars);
    queryBox.addEventListener('propertychange', replaceChars);
</script>
{% endblock %}